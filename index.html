<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <!-- Fixed layout width to keep a consistent canvas -->
    <meta name="viewport" content="width=1280, initial-scale=1" />

    <!-- Vega libs -->
    <script src="https://cdn.jsdelivr.net/npm/vega@5.25.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@5.17.0"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@6.26.0"></script>

    <!-- Your chart scripts -->
    <script src="stackednmap.js"></script>
    <script src="choro.js"></script>
    <script src="line.js"></script>
    <script src="scatter.js"></script>

    <title>FIT3179 A2</title>

    <style>
      /* ---------- Base & page shell ---------- */
      * {
        box-sizing: border-box;
      }
      body {
        margin: 0;
        background: #fafafa;
        font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto,
          Arial, sans-serif;
        color: #111;
      }
      :root {
        --page-width: 1400px; /* was 1300px */
        --cards-gap: 20px; /* space between the two cards */
        --viz-min-height: 460px; /* was 360–380px */
      }
      .page {
        width: var(--page-width);
        margin: 24px auto 64px;
        padding: 0 16px;
        overflow-x: auto; /* small screens can scroll horizontally */
      }

      /* ---------- Title & helper text ---------- */
      .title {
        text-align: center;
        font-weight: 900;
        font-size: 42px;
        line-height: 1.15;
        background: linear-gradient(90deg, #f6d7fc 0%, #ebfcde 100%);
        border-radius: 14px;
        padding: 16px 24px;
        margin: 0 0 10px;
        box-shadow: 0 2px 10px rgba(0, 0, 0, 0.06);
        font-family:Georgia, 'Times New Roman', Times, serif;
      }
      .title .crimes {
        color: #980043;
      }
      .title .gdp {
        color: #006837;
      }

      .subtitle {
        text-align: center;
        color: #5a5a5a;
        margin: 6px 0 22px;
        font-size: 14px;
      }
      .dropdown {
        font-weight: 800;
      }

      /* ---------- Cards ---------- */
      .card {
        background: #fff;
        border: 1px solid #ececec;
        border-radius: 12px;
        box-shadow: 0 4px 16px rgba(0, 0, 0, 0.05);
        padding: 16px 18px 18px;
        margin-bottom: 22px;
      }
      .card__header {
        display: flex;
        justify-content: center;
        align-items: center;
        margin-bottom: 6px;
      }
      .card__title {
        margin: 0;
        font-weight: 800;
        font-size: 18px;
        text-align: center;
      }
      .card__desc {
        margin: 8px auto 14px;
        color: #666;
        font-size: 14px;
        text-align: center;
        max-width: 980px;
      }
      .desc1 {
        margin: 8px auto 14px;
        color: #666;
        font-size: 14px;
        max-width: 980px;
      }
      .desc2 {
        margin: 8px auto 14px;
        color: #666;
        font-size: 14px;
        max-width: 980px;
        text-align: end;
      }

      /* row to place two cards side-by-side */
      .cards-row {
        display: flex;
        gap: var(--cards-gap);
        justify-content: center;
        align-items: stretch;
      }

      /* make each card take half the row */
      .card--half {
        flex: 1 1 0;
        width: calc(50% - (var(--cards-gap) / 2));
        min-width: 0; /* allow charts to shrink inside */
      }

      /* optional: keep a tidy chart area height */
      .vizbox {
        min-height: var(--viz-min-height);
      }

      /* optional safety: stack on very narrow screens */
      @media (max-width: 1000px) {
        .cards-row {
          flex-wrap: wrap;
        }
        .card--half {
          width: 100%;
        }
      }

      /* Viz container inside a card */
      .vizbox {
        background: #fff;
        border: 1px solid #efefef;
        border-radius: 10px;
        padding: 10px;
        min-height: 360px; /* avoids layout jump while loading */
      }
      .metadatabox {
        background: #fff;
        border: 1px solid #efefef;
        border-radius: 10px;
        padding: 10px;
        min-height: 50px;
      }

      .metadata {
        font-size: 8px;
        color:#666;
      }

      /* ---------- Section heading ---------- */
      .subsection {
        text-align: center;
        font-weight: 900;
        font-size: 24px;
        background: linear-gradient(90deg, #f3baff 0%, #d6fcba 100%);
        border: 1px solid rgba(0, 0, 0, 0.05);
        border-radius: 10px;
        padding: 10px 16px;
        margin: 28px 0 12px;
        font-family:Georgia, 'Times New Roman', Times, serif;
      }

      /* Make the inner wrapper a column so we can reorder its children */
      .vizbox .vega-embed .chart-wrapper {
        display: flex;
        flex-direction: column; /* controls + chart stacked top→bottom */
      }

      /* Put the controls ABOVE the chart, center them, and match styling */
      .vizbox .vega-embed .chart-wrapper .vega-bindings {
        order: -1; /* move before the chart */
        align-self: center; /* center inside the card */
        display: flex;
        flex-wrap: wrap;
        gap: 10px 12px;
        background: #f2f3f5;
        border: 1px solid #e3e5e8;
        border-radius: 10px;
        padding: 8px 12px;
        margin: 8px 0 12px;
      }
      /* make the map cards taller */
      .card--half .vizbox {
        min-height: 640px; /* try 640–720 depending on your specs */
        overflow: hidden; /* clip anything that bleeds out */
      }

      /* also clip the whole card just in case */
      .card {
        overflow: hidden;
      }

      /* Keep the chart itself after the controls */
      .vizbox .vega-embed .chart-wrapper .vega-view {
        order: 0;
      }

      /* Optional: make both cards’ controls the same width so they align */
      .cards-row .card .vega-bindings {
        min-width: 420px; /* tweak to taste (or remove) */
        justify-content: center;
      }

      .vizbox,
      .vizbox > div {
        width: 100%;
      }

      /* ---------- Vega-Embed tweaks: controls on top, grey toolbar ---------- */
      .vega-embed {
        display: flex;
        flex-direction: column;
      }
      .vega-embed .vega-bindings {
        order: -1; /* show above the chart */
        align-self: center;
        background: #f2f3f5;
        border: 1px solid #e3e5e8;
        border-radius: 10px;
        padding: 8px 12px;
        margin-bottom: 10px;
        display: flex;
        flex-wrap: wrap;
        gap: 10px 14px;
        justify-content: center;
        box-shadow: inset 0 1px 2px rgba(0, 0, 0, 0.04);
        align-content: center;
        height: 80px;
      }
      .vega-embed .vega-bindings label {
        font: 600 12px/1.2 system-ui, sans-serif;
        color: #444;
        margin-right: 6px;
      }
      .vega-embed .vega-bindings select {
        padding: 6px 8px;
        border-radius: 6px;
        border: 1px solid #cfd3da;
        background: #fff;
      }

      /* Prevent Vega from forcing responsive size; let specs decide sizes */
      .vega-embed {
        max-width: none !important;
      }

      /* Keep the three-dots icon small */
      .vega-actions svg {
        width: 16px !important;
        height: 16px !important;
      }

      .subtitle-desc {
        text-align: center;
        font: 600 22px/1.2 system-ui, sans-serif;
        color:#5a5a5a;

      }
      .motor {
        color: #b15928
      }

      .other {
        color: #cab2d6
      }

      .break-in {
        color: #ff7f00
      }
      .selangor {
        color:#1b9e77
      }
      .perlis {
        color: #bc80bd
      }
      .kl {
        color: #fb8072
      }

      .johor {
        color: #8dd3c7
      }

      .sarawak {
        color: #8c96c6
      }
      .sabah {
        color: #ffed6f
      }

    </style>
  </head>

  <body>
    <div class="page">
      <h1 class="title">
        <span class="crimes">Crimes</span> and
        <span class="gdp">GDP</span> (Gross Domestic Product) in Malaysia from
        2016 to 2023
      </h1>
      <p class="subtitle-desc">
        Explore how crime rate and GDP affects each another!
      </p>
      <!-- <p class="subtitle">
        Use the <span class="dropdown">dropdowns</span> to filter year and/or
        crime type. Bars show <span class="dropdown">detailed breakdown</span>.
      </p> -->

      <!-- Two map cards side-by-side -->
      <div class="cards-row">
        <!-- Card A: Total Crimes map -->
        <section class="card card--half">
          <div class="card__header">
            <h2 class="card__title">Total Crimes by State</h2>
          </div>
          <p class="card__desc">
            Circle size shows <span class="dropdown">population</span>; color shows <span class="dropdown">total crimes</span>. Toggle to <span class="dropdown">filter</span> view.
          </p>
          <div class="vizbox">
            <div id="stackednmap"></div>
          </div>
        </section>

        <!-- Card B: GDP Density map -->
        <section class="card card--half">
          <div class="card__header">
            <h2 class="card__title">GDP Density by State</h2>
          </div>
          <p class="card__desc">
            Darker greens indicate higher GDP density (GDP ÷ population). Toggle to <span class="dropdown">filter</span> view
          </p>
          <div class="vizbox">
            <div id="choro"></div>
          </div>
        </section>
      </div>

      <div class="cards-row">
        <!-- Card A description -->
        <section class="card card--half">
          <p class="desc1">
        <span class="dropdown">Selangor</span> records the <span class="dropdown">highest</span>  overall crime; <span class="dropdown">Perlis</span> the <span class="dropdown">lowest</span> . <br>
        Higher <span class="dropdown">population</span> generally aligns with higher total <span class="dropdown">crimes</span> . <br>
        Most crimes are <span class="motor">motorcycle thefts</span>, <span class="other">other thefts</span> and <span class="break-in">break-ins</span>.
      </p>
          
        </section>

        <!-- Card B description -->
        <section class="card card--half">
          
          <p class="desc2">
        <span class="dropdown">Kuala Lumpur</span> leads GDP density; <span class="dropdown">Pulau Pinang</span> is second. <br>
        <span class="dropdown">Sarawak</span> and <span class="dropdown">Selangor</span> alternate third and fourth across years. <br>
        Not the most populous, yet highest by GDP density.</p>
          
        </section>
      </div>

      <!-- Overview heading + Card C: Lines (line.js renders into #line) -->
      <h3 class="subsection">Overview</h3>
      <section class="card">
        <p class="card__desc">
          Use the <span class="dropdown">state selector</span> to focus any
          state, <span class="dropdown">slider</span> to see trend over selected year range.
        </p>
        <div class="vizbox">
          <div id="line"></div>
        </div>
      </section>
      <div class="cards-row">
        <!-- Card A description -->
        <section class="card card--half">
          <p class="desc1">
        Broad <span class="dropdown">decline</span> of crime rates especially from 2019 to 2021. <br>
        Likely coincides with COVID-19 restrictions. <br>
        <span class="selangor">Selangor</span> remains highest; <span class="perlis">Perlis</span> remains lowest. </p>
          
        </section>

        <!-- Card B description -->
        <section class="card card--half">
          
          <p class="desc2">
        <span class="dropdown">Steady growth</span> overall with a mild dip in 2020, then rebound. <br>
        <span class="selangor">Selangor</span> leads total GDP in Malaysia; <span class="kl">Kuala Lumpur</span> is next, <br>
        with <span class="johor">Johor</span> and <span class="sarawak">Sarawak</span> close behind.</p>
          
        </section>
      </div>

       <h3 class="subsection">Comparison View</h3>
      <section class="card">
        <p class="card__desc">
          Use the <span class="dropdown">state selector</span> to focus any
          state, <span class="dropdown">slider</span> to see trend over selected year range.
        </p>
        <div class="vizbox">
          <div id="scatter"></div>
        </div>
      </section>

      <div class="cards-row">
        <!-- Card A description -->
        <section class="card card--half">
          <p class="desc1">
        <span class="dropdown">Across states</span>,larger populations are associated with both higher GDP <br>
        and more recorded crimes; the cross-state trend is positive.<br>
        </section>

        <!-- Card B description -->
        <section class="card card--half">
          
          <p class="desc2">
        <span class="dropdown">Within state</span>, most year-to-year lines slope downward, higher GDP years <br>
         tend to coincide with fewer crimes, with <span class="sabah">Sabah</span> as the main exception.

          
        </section>
      </div>
      
       <div class="metadatabox">
          <div class="metadata">Created by Chok Huey Yan on 19 Oct 2025 <br><br></br>Data Sources:
            <br>  1. crime - https://data.gov.my/data-catalogue/crime_district?state=johor&district=all&category=assault&type=theft-other&visual=table 
<br>2. malaysia coords - https://www.kaggle.com/datasets/mypapit/malaysiancity   
<br>3. population - https://open.dosm.gov.my/data-catalogue/population_state?state=kedah&visual=table 
<br>4. economy - https://open.dosm.gov.my/data-catalogue/gdp_state_real_supply?series=abs&state=kelantan&sector=p0&visual=table 
</div>
        </div>
    </div>
  </body>
</html>
